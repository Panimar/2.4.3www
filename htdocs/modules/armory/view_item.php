<?php	header("Content-Type: content=text/html; charset=cp1251");	include_once '../../include/config.php';	include_once '../../include/functions.php';	include_once '../../include/classes/class.item.php';	include_once './view_item_str.php';		if (isset($_GET['realm'])) {		if (preg_match("/^[0-9]+$/", $_GET['realm'])) {			$realm_num = $_GET['realm'];			if ($realm_num < '1' || $realm_num > $realm_count) { $realm_num = '1';} 		} else { $realm_num = '1'; }	} else { $realm_num = '1'; }		if (isset($_GET['item'])) {		if (preg_match("/^[0-9]+$/", $_GET['item'])) {			$item = $_GET['item'];		} else { $item = '0'; }	} else { $item = '0'; }		if (isset($_GET['type'])) {		if (preg_match("/^[0-9]+$/", $_GET['type'])) {			$type = $_GET['type'];			if ($type < '0' || $type > '1') { $type = '0';} 		} else { $type = '0'; }	} else { $type = '0'; }		$s_item = new Item();	$s_item -> ConnectToDB($realm_num);	$s_item -> LoadFromDB($realm_num, $type, $item);		//echo ($s_item -> GetENTRY())." ".$item_guid;		$page_text = "<table border=\"0\" width=\"300px\" style=\"text-align: left; font-family:Verdana; font-size: 12;\">";	/*Вывод имени*/	$page_text .= "<tr><td><div style=\"color: ".$item_name_color[($s_item -> GetQUALITY())]."; text-align: left;\">".$s_item -> GetNAME()."</div></td></tr>";		/*Вывод бинда*/	if (($s_item -> GetBONDING()) > 0) {$page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">".@$item_bonding_text[($s_item -> GetBONDING())]."</div></td></tr>";}		/*Уникальная ли*/	if (($s_item -> GetMAXCOUNT()) == 1) {$page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">Уникальный</div></td></tr>";}	if (($s_item -> GetMAXCOUNT()) > 1) {$page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">Уникальный (".($s_item -> GetMAXCOUNT()).")</div></td></tr>";}		/*Вывод слота*/	if (($s_item -> GetINVENTORYTYPE()) > 0 && ($s_item -> GetCONTAINERSLOTS()) == 0) {$page_text .= "<tr><td><div style=\"float: left; width: 50%; color: #fff; text-align: left; \">".@$item_slot_name[($s_item -> GetINVENTORYTYPE())]."</div><div style=\"float: left; width: 50%; color: #fff; text-align: right;\">".@$item_type_name[($s_item -> GetCLASS())][($s_item -> GetSUBCLASS())]."</div></td></tr>";}	if (($s_item -> GetINVENTORYTYPE()) > 0 && ($s_item -> GetCONTAINERSLOTS()) > 0) {$page_text .= "<tr><td><div style=\"float: left; width: 50%; color: #fff; text-align: left; \">".@$item_slot_name[($s_item -> GetINVENTORYTYPE())]." (".($s_item -> GetCONTAINERSLOTS())." слота)</div></td></tr>";}		/*Вывод урона*/	if (($s_item -> GetDMGMIN(1)) > 0) {$page_text .= "<tr><td><div style=\"float: left; width: 50%; color: #fff; text-align: left;\">Урон: ".ceil($s_item -> GetDMGMIN(1))." - ".ceil($s_item -> GetDMGMAX(1))."".@$item_dt_text[($s_item -> GetDMGTYPE(1))]."</div><div style=\"float: left; width: 50%; color: #fff; text-align: right;\">Скорость ".(($s_item -> GetDMGSPEED())/1000)."</div></td></tr>";}	if (($s_item -> GetDMGMIN(1)) > 0) {$page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">(".($s_item -> GetDMGMID(1))." ед. урона в секунду)</div></td></tr>";}		/*Вывод брони*/	if (($s_item -> GetARMOR()) > 0) { $page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">Броня: ".($s_item -> GetARMOR())."</div></td></tr>"; }		/*Основные статы*/	for ($i = 3; $i <= 7; $i++) {		for ($n = 1; $n <= 10; $n++) {			if (($s_item -> GetSTATTYPE($n)) == $i) { $page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">+".($s_item -> GetSTATVALUE($n))." ".$item_st_text[$i]."</div></td></tr>"; }		}	}		/*Спелрезист*/	for ($i = 0; $i <= 5; $i++) { if (($s_item -> GetSPELLRES($i)) > 0) { $page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">+".($s_item -> GetSPELLRES($i))." ".$item_res_text[$i]."</div></td></tr>"; } }		/*Вывод статов рандом вещи*/	if ($type == 0) {		if (($s_item -> GetRANDOMPROPERTYID()) < 0) {			if (($s_item -> GetRSENCHID(1)) > 0 && strlen($s_item -> GetRSENCHDESC(1))) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">".($s_item -> GetRSENCHDESC(1))."</div></td></tr>"; }			if (($s_item -> GetRSENCHID(2)) > 0 && strlen($s_item -> GetRSENCHDESC(2))) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">".($s_item -> GetRSENCHDESC(2))."</div></td></tr>"; }			if (($s_item -> GetRSENCHID(3)) > 0 && strlen($s_item -> GetRSENCHDESC(3))) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">".($s_item -> GetRSENCHDESC(3))."</div></td></tr>"; }			if (($s_item -> GetRSENCHID(4)) > 0 && strlen($s_item -> GetRSENCHDESC(4))) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">".($s_item -> GetRSENCHDESC(4))."</div></td></tr>"; }		} elseif (($s_item -> GetRANDOMPROPERTYID()) > 0) {			if (($s_item -> GetRPENCHID(1)) > 0 && strlen($s_item -> GetRPENCHDESC(1))) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">".($s_item -> GetRPENCHDESC(1))."</div></td></tr>"; }			if (($s_item -> GetRPENCHID(2)) > 0 && strlen($s_item -> GetRPENCHDESC(2))) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">".($s_item -> GetRPENCHDESC(2))."</div></td></tr>"; }			if (($s_item -> GetRPENCHID(3)) > 0 && strlen($s_item -> GetRPENCHDESC(3))) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">".($s_item -> GetRPENCHDESC(3))."</div></td></tr>"; }			if (($s_item -> GetRPENCHID(4)) > 0 && strlen($s_item -> GetRPENCHDESC(4))) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">".($s_item -> GetRPENCHDESC(4))."</div></td></tr>"; }		}	} elseif (($s_item -> GetRANDOMITEM()) > 0) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\"><Случайное заклинание></div></td></tr>"; }		/*Вывод сокетов*/	for ($i = 1; $i <= 3; $i++) {		if (($s_item -> GetSOCKET($i)) > 0 && $type == 0) {			$page_text .= "<tr><td><div style=\"float: left; width: 20px; height: 17px; margin-left: 2px; margin-top: 2px;\"><img src=\"http://static.wowhead.com/images/wow/icons/small/".strtolower($s_item -> GetSOCKETICON($i)).".jpg\" width=\"14px\" height=\"14px\" /></div><div style=\"color: #fff; float: left; width: 260px; text-align: left; margin-top: 1px;\">".($s_item -> GetSOCKETDESC($i))."</div></td></tr>";		} elseif (($s_item -> GetSOCKETSLOTCOLOR($i)) > 0) {			$page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">".$item_socket_text[($s_item -> GetSOCKETSLOTCOLOR($i))]."</div></td></tr>";		}	}	if ($type == 0) {		if ($s_item -> GetSOCKETSLOTCOLOR(1) > 0) {			if ($s_item -> GetSOCKETBONUS() > 0) {				$page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">При соответствии цвета: ".($s_item -> GetSOCKETBONUSDESC())."</div></td></tr>";			} else { $page_text .= "<tr><td><div style=\"color: #9d9d9d; text-align: left;\">При соответствии цвета: ".($s_item -> GetSOCKETBONUSDESC())."</div></td></tr>"; }		}	} elseif ($s_item -> GetSOCKETSLOTCOLOR(1) > 0) { $page_text .= "<tr><td><div style=\"color: #9d9d9d; text-align: left;\">При соответствии цвета: ".($s_item -> GetSOCKETBONUSDESC())."</div></td></tr>"; }		/*Вывод постоянного чантов*/	if (($s_item -> GetENCHANTMENTS(0)) > 0) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">".($s_item -> GetENCHANTMENTSDESC(0))."</div></td></tr>"; }	if (($s_item -> GetENCHANTMENTS(3)) > 0) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">".($s_item -> GetENCHANTMENTSDESC(3))."</div></td></tr>"; }		/*Вывод прочности*/	if ($type == 0) {	if (($s_item -> GetMAXDURABILITY()) > 0) { $page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">Прочность: ".($s_item -> GetDURABILITY())."/".($s_item -> GetMAXDURABILITY())."</div></td></tr>"; }	} elseif (($s_item -> GetMAXDURABILITY()) > 0) { $page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">Прочность: ".($s_item -> GetMAXDURABILITY())."/".($s_item -> GetMAXDURABILITY())."</div></td></tr>"; }		/*Доступные классы*/	$a_allclass = '1';	$b = 0;	$class = "<tr><td><div style=\"color: #fff; text-align: left;\">Классы: ";	if ((($s_item -> GetALLOWABLECLASS())&1) == '1') { if ($b == 1) {$class .= ", ";} else {$b = 1;} $class .= "Воин";  } else { $a_allclass = '0'; }	if ((($s_item -> GetALLOWABLECLASS())&2) == '2') { if ($b == 1) {$class .= ", ";} else {$b = 1;} $class .= "Паладин"; } else { $a_allclass = '0'; }	if ((($s_item -> GetALLOWABLECLASS())&4) == '4') { if ($b == 1) {$class .= ", ";} else {$b = 1;} $class .= "Охотник"; } else { $a_allclass = '0'; }	if ((($s_item -> GetALLOWABLECLASS())&8) == '8') { if ($b == 1) {$class .= ", ";} else {$b = 1;} $class .= "Разбойник"; } else { $a_allclass = '0'; }	if ((($s_item -> GetALLOWABLECLASS())&16) == '16') { if ($b == 1) {$class .= ", ";} else {$b = 1;} $class .= "Жрец"; } else { $a_allclass = '0'; }	if ((($s_item -> GetALLOWABLECLASS())&32) == '32') {if ($b == 1) {$class .= ", ";} else {$b = 1;} $class .= "Рыцарь смерти"; } else { $a_allclass = '0'; }	if ((($s_item -> GetALLOWABLECLASS())&64) == '64') {if ($b == 1) {$class .= ", ";} else {$b = 1;} $class .= "Шаман"; } else { $a_allclass = '0'; }	if ((($s_item -> GetALLOWABLECLASS())&128) == '128') {if ($b == 1) {$class .= ", ";} else {$b = 1;} $class .= "Маг"; } else { $a_allclass = '0'; }	if ((($s_item -> GetALLOWABLECLASS())&256) == '256') {if ($b == 1) {$class .= ", ";} else {$b = 1;} $class .= "Чернокнижник"; } else { $a_allclass = '0'; }	if ((($s_item -> GetALLOWABLECLASS())&1024) == '1024') {if ($b == 1) {$class .= ", ";} else {$b = 1;} $class .= "Друид"; } else { $a_allclass = '0'; }	$class .= "</div></td></tr>";	if ($a_allclass == 0) {$page_text .= $class;}		/*Доступные расы*/	$a_allrace = '1';	$b = 0;	$races = "<tr><td><div style=\"color: #fff; text-align: left;\">Расы: ";	if ((($s_item -> GetALLOWABLERACE())&1) == '1') { if ($b == 1) {$races .= ", ";} else {$b = 1;} $races .= "Человек";  } else { $a_allrace = '0'; }	if ((($s_item -> GetALLOWABLERACE())&2) == '2') { if ($b == 1) {$races .= ", ";} else {$b = 1;} $races .= "Орк"; } else { $a_allrace = '0'; }	if ((($s_item -> GetALLOWABLERACE())&4) == '4') { if ($b == 1) {$races .= ", ";} else {$b = 1;} $races .= "Дворф"; } else { $a_allrace = '0'; }	if ((($s_item -> GetALLOWABLERACE())&8) == '8') { if ($b == 1) {$races .= ", ";} else {$b = 1;} $races .= "Ночной эльф"; } else { $a_allrace = '0'; }	if ((($s_item -> GetALLOWABLERACE())&16) == '16') { if ($b == 1) {$races .= ", ";} else {$b = 1;} $races .= "Нежить"; } else { $a_allrace = '0'; }	if ((($s_item -> GetALLOWABLERACE())&32) == '32') {if ($b == 1) {$races .= ", ";} else {$b = 1;} $races .= "Таурен"; } else { $a_allrace = '0'; }	if ((($s_item -> GetALLOWABLERACE())&64) == '64') {if ($b == 1) {$races .= ", ";} else {$b = 1;} $races .= "Гном"; } else { $a_allrace = '0'; }	if ((($s_item -> GetALLOWABLERACE())&128) == '128') {if ($b == 1) {$races .= ", ";} else {$b = 1;} $races .= "Тролль"; } else { $a_allrace = '0'; }	if ((($s_item -> GetALLOWABLERACE())&512) == '512') {if ($b == 1) {$races .= ", ";} else {$b = 1;} $races .= "Кровавый эльф"; } else { $a_allrace = '0'; }	if ((($s_item -> GetALLOWABLERACE())&1024) == '1024') {if ($b == 1) {$races .= ", ";} else {$b = 1;} $races .= "Дреней"; } else { $a_allrace = '0'; }	$races .= "</div></td></tr>";	if ($a_allrace == 0) {$page_text .= $races;}		/*Требуемый уроверь*/	if (($s_item -> GetREQUIREDLEVEL()) > 0) { $page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">Требуется уровень: ".($s_item -> GetREQUIREDLEVEL())."</div></td></tr>"; }		/*Требуемый скил*/	if (($s_item -> GetREQUIREDSKILL()) > 0) { $page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">Требуется: ".($s_item -> GetREQUIREDSKILLDESC())." (".($s_item -> GetREQUIREDSKILLRANK()).")</div></td></tr>"; }		/*Требуемая репа*/	if (($s_item -> GetREQUIREDREPUTATIONFACTION()) > 0) { $page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">Требуется: ".($faction_rep_rank[($s_item -> GetREQUIREDREPUTATIONRANK())])." у фракции ".($s_item -> GetREQUIREDREPUTATIONFACTIONNAME())."</div></td></tr>"; }		/*Вывод уровня*/	if ($s_item -> GetLEVEL() > 0 ) { $page_text .= "<tr><td><div style=\"color: #fff; text-align: left;\">Уровень предмета: ".($s_item -> GetLEVEL())."</div></td></tr>"; }		/*Вывод доп статов*/	for ($n = 1; $n <= 10; $n++) {		if ($s_item -> GetSTATTYPE($n) == 46) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">Если на персонаже: Восстанавливает ".($s_item -> GetSTATVALUE($n))." ед. здоровья раз в 5 сек.</div></td></tr>"; }		if ($s_item -> GetSTATTYPE($n) == 47) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">Если на персонаже: Восстанавливает ".($s_item -> GetSTATVALUE($n))." ед. маны раз в 5 сек.</div></td></tr>"; }	}	for ($i = 12; $i <= 45; $i++) {		for ($n = 1; $n <= 10; $n++) {			if ($s_item -> GetSTATTYPE($n) == $i && $s_item -> GetSTATVALUE($n) > 0) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">Если на персонаже: ".$item_st_text[$i]." +".($s_item -> GetSTATVALUE($n))."</div></td></tr>"; }		}	}		/*Вывод заклинаний*/	for ($i = 1; $i <= 5; $i++) {		if (($s_item -> GetSPELL($i)) > 0 && strlen(($s_item -> GetSPELLDESC($i)))) { $page_text .= "<tr><td><div style=\"color: #1eff00; text-align: left;\">".$spell_trigger_text[($s_item -> GetSPELLTRIGGER($i))].":  ".($s_item -> GetSPELLDESC($i))."</div></td></tr>"; }	}		$page_text .= "</table>";	echo $page_text;	$s_item -> CloseConnectToDB($realm_num);	?>